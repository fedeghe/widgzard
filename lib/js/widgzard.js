/*
 _ _ _ _____ ____  _____ _____ _____ _____ ____  
| | | |     |    \|   __|__   |  _  | __  |    \ 
| | | |-   -|  |  |  |  |   __|     |    -|  |  |
|_____|_____|____/|_____|_____|__|__|__|__|____/
												v.0.2
*
* @build 19/10/2017
* @author Federico Ghedina <federico.ghedina@gmail.com>
* Y 2017
* ~22KB
*/
!function(){!function(e){"use strict";function t(e,n,o){e=e.replace(/^\//,"");var r,i=e.split(/\.|\//),c=i.length;return void 0===o&&(o=window),void 0===n&&(n={}),"function"==typeof n&&(n=n()),o[i[0]]||(o[i[0]]=1===c?n:{}),r=o[i[0]],c>1?t(i.slice(1).join("."),n,o[i[0]]):r}function n(e,t){e=e.replace(/^\//,"");var n=e.split(/\.|\//),o=0,r=n.length;if(t=void 0!==t?t:window,!e)return t;for(null;o<r;o+=1){if(void 0===t[n[o]])return;t=t[n[o]]}return t}function o(e,t){var n,o="function"==typeof t?t():t;for(n in o)void 0===e[n]&&(e[n]=o[n])}t("EW",{makeNs:t,checkNs:n,extendNs:o,debug:function(){var e=Array.prototype.slice.call(arguments,0);"debug"in console&&console.debug.apply(console,e)},log:function(){var e=Array.prototype.slice.call(arguments,0);"log"in console&&console.log.apply(console,e)},dbg:function(e){try{console.log(e)}catch(t){try{opera.postError(e)}catch(t){alert(e)}}}}),t("EW.utils",{uniqueId:new function(){var e=0,t=this;this.prefix="EW_",this.toString=function(){return t.prefix+ ++e}}})}(),EW.makeNs("EW/events"),function(){var e={events:{wwdb_bindings:{},getElementDeterminant:function(e){return e.tagName.match(/input|textarea/i)?"value":"innerHTML"}}};EW.events.on=function(e){return"addEventListener"in e?function(e,t,n){e.addEventListener.apply(e,[t,n,!1])}:"attachEvent"in e?function(e,t,n){e.attachEvent.apply(e,["on"+t,n])}:function(){throw new Error("No straight way to bind an event")}}(this),EW.events.eventTarget=function(e){e=e||window.event;var t=e.currentTarget||void 0!==e.target?e.target:e.srcElement;if(!t)return!1;for(;3===t.nodeType&&null!==t.parentNode;)t=t.parentNode;return t},EW.events.kill=function(e){return e||(e=W.event,e.cancelBubble=!0,e.returnValue=!1),"stopPropagation"in e&&e.stopPropagation()&&e.preventDefault(),!1},EW.events.ready=function(){var e=[],t=setInterval(function(){if("complete"===document.readyState){clearInterval(t);for(var n=0,o=e.length;n<o;n++)e[n].call(this)}},10);return function(t){"complete"===document.readyState?t.call(this):e.push(t)}}(),EW.events.ww={on:function(t,n,o,r){var i=!1,c=!1,a=e.events.getElementDeterminant(o),s=o[a],l=t[n],u=function(e){i=c=!!e};o.wwdbID="_"+EW.utils.uniqueid,e.events.wwdb_bindings[o.wwdbID]=window.setInterval(function(){i||(u(!0),l!=t[n]&&(s=t[n],l=s,o[a]=s),u(!1))},25),EW.events.on(o,"keyup",function(){c||(u(!0),this[a]!==t[n]&&(t[n]=this[a],s=this[a],l=this[a]),u(!1))}),o[a]=l},off:function(){for(var t=[].slice.call(arguments,0),n=t.length;n-- >0;)EW.events.off(t[n],"keyup"),window.clearInterval(e.events.wwdb_bindings[t[n].wwdbID])}}}(),EW.makeNs("EW/i18n",function(){var e={};return EW.lang="undefined"!=typeof sm_lang?sm_lang:"en",{check:function(e){return e.match(/i18n\(([^}|]*)?\|?([^}]*)\)/)},dynamicLoad:function(t,n){for(n in t)EW.lang in t[n]&&(e[n]=t[n][EW.lang])},get:function(t,n){return EW.checkNs(t,e)||n||"no Value"},load:function(t){e=t},parse:function(e){var t,n,o,r,i=EW.object.digForValue(e,/i18n\(([^}|]*)?\|?([^}]*)\)/);for(o=0,r=i.length;o<r;o++)(typeof i[o].regexp).match(/boolean/i)||(t=EW.i18n.check(i[o].regexp[0]))&&(n=EW.checkNs(i[o].container,e),n[i[o].key]=EW.i18n.get(t[1],t[2]))}}}),EW.makeNs("EW/io"),EW.io=function(){"use strict";var W=window,xdr=void 0!==W.XDomainRequest&&document.all&&!navigator.userAgent.match(/opera/i),_={getxhr:function(e){var t,n=["Msxml2.XMLHTTP","Msxml3.XMLHTTP","Microsoft.XMLHTTP"],o=n.length,r=0;if(xdr&&e.cors)t=new W.XDomainRequest;else try{t=new W.XMLHttpRequest}catch(e){for(null;r<o;r+=1)try{t=new W.ActiveXObject(n[r])}catch(e){continue}!t&&alert("No way to initialize XHR")}return t},setHeaders:function(e,t){var n={xml:"text/xml",html:"text/html",json:"application/json"}[t]||"text/html";e.setRequestHeader("Accept",n+"; charset=utf-8")},setMultipartHeader:function(e){e.setRequestHeader("Content-Type","multipart/form-data")},setCookiesHeaders:function(e){var t,n,o;for(t=SB.cookie.getall(),n=0,o=t.length;n<o;)e.setRequestHeader("Cookie",t[n].name+"="+t[n].value),n++},ajcall:function(e,t){var n,o,r=_.getxhr(t),i=t&&t.method||"POST",c=t&&t.cback,a=t&&t.opened||function(){},s=t&&t.loading||function(){},l=t&&t.error||function(){},u=t&&t.abort||function(){},f=t&&t.sync,d=t&&t.data||{},p=t&&t.type||"text/html",h=!t||void 0===t.cache||t.cache,m="xml"===p?"responseXML":"responseText",g=t&&t.timeout||1e4,v=t&&t.hasFiles,b=!1,y=!1,E=!1,w=!1;if(h||(d.C=+new Date),"GET"===i)d=SB.object.toQs(d).substr(1);else{n=new FormData;for(o in d)n.append(o,d[o]);d=n}if(xdr&&t.cors){r.open(i,"GET"===i?e+(d?"?"+d:""):e),r.onerror=l,r.ontimeout=function(){},r.onprogress=function(e){if(e.lengthComputable){var t=e.loaded/e.total*100;console.log(t+"% uploaded")}},r.onload=function(e){c(r.responseText)},r.timeout=3e3,_.setHeaders(r,v,p);var o={xml:"text/xml",html:"text/html",json:"application/json"}[p]||"text/html";r.contentType=o,window.setTimeout(function(){r.send()},20)}else{r.onreadystatechange=function(){if(w===r.readyState)return!1;if(w=r.readyState,4==~~r.readyState&&0==~~r.status)return r.onerror({error:404,xhr:r,url:e}),r.abort(),!1;if("complete"===w||4==~~w&&200==~~r.status)return b=!0,404==~~r.status?(r.onerror.call(r),!1):(c&&(y=r[m],function(){c(y)}()),E=r[m],W.setTimeout(function(){r=null},50),E);if(3===w)s(r);else if(2===w)a(r);else if(1===w)switch(v?_.setHeaders(r,"json"):_.setHeaders(r,p),i){case"POST":case"PUT":try{r.send(d||!0)}catch(e){}break;case"GET":try{r.send(null)}catch(e){}break;default:alert(i),r.send(null)}return!0},r.onerror=function(){l&&l.apply(null,arguments)},r.onabort=function(){u&&u.apply(null,arguments)},r.open(i,"GET"===i?e+(d?"?"+d:""):e,f),W.setTimeout(function(){b||(b=!0,r.abort())},g);try{return"responseXML"===m?r[m].childNodes[0]:r[m]}catch(e){}}return!0}};return{getxhr:_.getxhr,post:function(uri,cback,sync,data,cache,files,err){return _.ajcall(uri,{cback:function(r){files?(r=r.replace(/(?:\/\*(?:[\s\S]*?)\*\/)|(?:([\s;])+\/\/(?:.*)$)/gm,""),cback(window.JSON&&window.JSON.parse?JSON.parse(r):eval("("+r+")"))):cback(r)},method:"POST",sync:sync,data:data,cache:cache,error:err,hasFiles:!!files})},get:function(e,t,n,o,r,i){return _.ajcall(e,{cback:t||function(){},method:"GET",sync:n,data:o,cache:r,error:i})},put:function(e,t,n,o,r,i){return _.ajcall(e,{cback:t,method:"PUT",sync:n,data:o,cache:r,error:i})},getJson:function(uri,cback,data,cors){return _.ajcall(uri,{type:"json",method:"GET",sync:!1,cback:function(r){r=r.replace(/(?:\/\*(?:[\s\S]*?)\*\/)|(?:([\s;])+\/\/(?:.*)$)/gm,""),cback(W.JSON&&W.JSON.parse?JSON.parse(r):eval("("+r+")"))},data:data,cors:!!cors})},getXML:function(e,t){return _.ajcall(e,{method:"GET",sync:!1,type:"xml",cback:t||function(){}})}}}(),EW.object=function(){function e(e,t){var n,o="";for(n in e)e.hasOwnProperty(n)&&(o+=t(e,n,o));return o}function t(e,t){return n(e)||"undefined"==typeof JSON?e==t:JSON.stringify(e)===JSON.stringify(t)}function n(e){return"object"==typeof Node?e instanceof Node:e&&"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName}function o(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName}function r(e,r,i,c){if(!e.match(/key|value|keyvalue/))throw new Error("Bad param for object.digFor");c=~~c;var a=0,s={key:function(e,n,o){return EW.object.isString(e)&&o instanceof RegExp?e.match(o):t(e,o)},value:function(e,n,o){return EW.object.isString(n)&&o instanceof RegExp?n.match(o):t(n,o)},keyvalue:function(e,n,o){return(EW.object.isString(e)&&o.key instanceof RegExp?e.match(o.key):t(e,o.key))&&(EW.object.isString(n)&&o.value instanceof RegExp?n.match(o.value):t(n,o.value))}}[e],l=[],u=function(e,t,n,o,r){var i=[].concat.call(e,[t]),c=s(t,o[t],n);c&&(l.push({obj:o,value:o[t],key:i[i.length-1],parentKey:i[i.length-2],path:i.join("/"),container:i.slice(0,i.length-1).join("/"),parentContainer:i.slice(0,i.length-2).join("/"),regexp:c,level:r}),a++),f(o[t],n,i,r+1)},f=function(e,t,r,i){if(!n(e)&&!o(e)){var s,l;if(e instanceof Array)for(s=0,l=e.length;s<l&&(u(r,s,t,e,i),!c||c!=a);s++);else{if("object"!=typeof e)return;for(s in e)if(u(r,s,t,e,i),c&&c==a)break}}};return f(r,i,[],0),l}return{fromQs:function(){var e,t,n,o=document.location.search.substr(1).split("&"),r=[];for(e=0,t=o.length;e<t;e+=1)n=o[e].split("="),!r[n[0]]&&(r[n[0]]=decodeURIComponent(n[1]));return r},clone:function(e){var t,n,o,r=EW.object;if(null===e||"object"!=typeof e)return e;if(e instanceof Date)return t=new Date,t.setTime(e.getTime()),t;if(e instanceof Array){for(t=[],n=0,o=e.length;n<o;n++)t[n]=r.clone(e[n]);return t}if(e instanceof Object){t={};for(n in e)e.hasOwnProperty(n)&&(t[n]=r.clone(e[n]));return t}throw new Error("Unable to copy obj! Its type isn't supported.")},digForKey:function(e,t,n){return r("key",e,t,n)},digForValue:function(e,t,n){return r("value",e,t,n)},digForKeyValue:function(e,t,n){return r("keyvalue",e,t,n)},extend:function(e,t,n){var o,r=EW.object.clone(e);for(o in t)!t.hasOwnProperty(o)||o in r&&!n||(r[o]=t[o]);return r},isString:function(e){return"string"==typeof e||e instanceof String},jCompare:t,toQs:function(t){return e(t,function(e,t,n){return((n?"&":"?")+encodeURIComponent(t)+"="+encodeURIComponent(e[t])).replace(/\'/g,"%27")})}}}(),EW.Promise=function(){var e=function(){this.cbacks=[],this.solved=!1,this.result=null},t=e.prototype;return t.then=function(e,t){var n=this,o=function(){n.solved=!1,e.apply(t||n,[t||n,n.result])};return this.solved?o():this.cbacks.push(o),this},t.done=function(){var e=[].slice.call(arguments,0);if(this.result=e,this.solved=!0,!this.cbacks.length)return this.result;this.cbacks.shift()(e)},{create:function(){return new e}}}(),EW.Channel=function(){var e={},t=function(e,t){if("indexOf"in e)return e.indexOf(t);for(var n=e.length-1;e[n]!==t;)n--;return n},n=function(){this.topic2cbs={},this.lateTopics={},this.enabled=!0};return n.prototype={enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},pub:function(e,t){var n,o=0;if(!(e in this.topic2cbs&&this.enabled))return e in this.lateTopics?this.lateTopics[e].push({args:t}):this.lateTopics[e]=[{args:t}],!1;for(n=this.topic2cbs[e].length;o<n;o+=1)this.topic2cbs[e][o].apply(null,[e].concat(t));return!0},sub:function(e,n,o){var r,i=0;if(e instanceof Array)for(r=e.length;i<r;i+=1)this.sub(e[i],n,o);if(e in this.topic2cbs&&this.enabled||(this.topic2cbs[e]=[]),!o&&t(this.topic2cbs[e],n)>=0)return this;if(this.topic2cbs[e].push(n),e in this.lateTopics)for(i=0,r=this.lateTopics[e].length;i<r;i++)n.apply(null,[e].concat(this.lateTopics[e][i].args))},unsub:function(e,n){var o,r=0;if(e instanceof Array)for(o=e.length;r<o;r+=1)this.unsub(e[r],n);return e in this.topic2cbs&&(r=t(this.topic2cbs[e],n))>=0&&this.topic2cbs[e].splice(r,1),e in this.lateTopics&&(r=t(this.lateTopics[e],n))>=0&&this.lateTopics[e].splice(r,1),this},once:function(e,t){function n(){t.apply(null,Array.prototype.slice.call(arguments,0)),o.unsub(e,n)}var o=this;this.sub(e,n)},reset:function(){var e=Array.prototype.slice.call(arguments,0),t=e.length,n=0;if(!t)return this.topic2cbs={},this.lateTopics={},this;for(null;n<t;n+=1)e[n]in this.topic2cbs&&(this.topic2cbs[e[n]]=[]),e[n]in this.lateTopics&&(this.lateTopics[e[n]]=[]);return this}},function(t){return t in e||(e[t]=new n),e[t]}}(),function(){"use strict";function Wnode(e,t,n){var o=this,r=e.tag||"div";this.target=t,this.node=e.ns?document.createElementNS(e.ns,r):document.createElement(r),this.conf=e,this.root=n.root,this.parent=t,this.map=n.map,this.abort=n.abort,this.getNode=n.getNode,this.getNodes=n.getNodes,this.WIDGZARD_promise=__promise.create(),this.WIDGZARD_cb=e.cb||function(){__debug&&console.log("autoresolving  ",o.node),o.resolve()},this.WIDGZARD_promise.then(o.WIDGZARD_cb,o),this.WIDGZARD_len=e.content?e.content.length:0,this.done=this.resolve=this.solve=function(){0==--o.target.WIDGZARD_len&&(o.target.WIDGZARD_promise?o.target.WIDGZARD_promise.done():o.target.WIDGZARD_cb())},this.lateWid=n.lateWid}function cleanupWnode(e){var t=e.node,n=[],o=["WIDGZARD","WIDGZARD_cb","WIDGZARD_promise","WIDGZARD_length","parent","getNode","climb","root","done","resolve","data"],r=o.length,i=0,c=0,a=0,s=null;for(eulerWalk(t,function(e){e!==t&&3!=e.nodeType&&n.push(e)&&a++},"post");c<a;){for(s=n[c++];i<r;)s[o[i++]]=null;!function(e){e.parentNode.removeChild(e)}(s)}return n=null,o=null,!0}function render(e,t,n){var o,r,i=+new Date,c={node:e.target||document.body,endFunctions:[],childrens:[],reload:function(){render(e,!0)}},a={node:document.createDocumentFragment("div")},s=!0,l=c.node.innerHTML+"";if(__debug=!!e.debug,__autoclean&&c.WIDGZARD&&cleanupWnode(c),!e)throw new Exception("ERROR : Check parameters for render function");return r={root:c,map:{},getNode:function(e){return r.map[e]||!1},getNodes:function(){return r.map},abort:function(){return s=!1,c.node.innerHTML=l,"onAbort"in e&&(typeof e.onAbort).match(/function/i)&&e.onAbort.call(null,e),!1},lateWid:function(e){r.map[e]=this}},Wnode.prototype.setAttrs(c.node,e.attrs).setStyle(c.node,e.style).setData(c,e.data).setData(a,e.data),a.descendant=Wnode.prototype.descendant,t&&(c.node.innerHTML=""),void 0!==e.html&&(c.node.innerHTML=replaceDataInHTML(e.html,e.html)),a.WIDGZARD_len=e.content?e.content.length:0,a.WIDGZARD_cb=c.WIDGZARD_cb=function(){if(s&&c.node.appendChild(a.node)&&e.cb&&e.cb.call(c),c.endFunctions.length)for(var t=0,n=c.endFunctions.length;t<n;t++)c.endFunctions[t]()},c.WIDGZARD=!0,c.getNode=r.getNode,c.getNodes=r.getNodes,c.abort=r.abort,c.map=r.map,c.report=function(){window.JSON&&console.log("json size : "+JSON.stringify(e).length),console.log("html size : "+c.node.innerHTML.length)},Wnode.prototype.checkInit(a,e),function e(t,n){if(!s)return!1;if(t.content)for(var o=0,i=t.content.length;o<i;o++)t.content[o]===__clearerClassName&&(t.content[o]={tag:"br",attrs:{class:__clearerClassName}}),"ns"in t&&(t.content[o].ns=t.ns),e(t.content[o],new Wnode(t.content[o],n,r).render())}(e,a),"content"in e||a.WIDGZARD_cb(),!n||n in __renders||(__renders[n]=c),o=+new Date,console.log("Widgzard render time: "+(o-i)+"ms"),c}function replaceDataInHTML(e,t){return e.replace(/\$([A-z]*)\$/g,function(e,n){var o=n.replace(/\$/g,"");return o in t?t[o]:n})}function get(e){var t=document.createElement("div");return e.target=t,render(e),t}function cleanup(e,t){render({target:e,content:[{html:t||""}]},!0)}function load(e){var t=document.createElement("script");document.getElementsByTagName("head")[0].appendChild(t),t.onload=function(){t.parentNode.removeChild(t)},t.src=e}function eulerWalk(e,t,n){n={pre:"pre",post:"post"}[n]||"post";var o=function(){},r="pre"===n?t:o,i="post"===n?t:o;!function e(t,n){for(r(t),n=t.firstChild;n;)e(n),n=n.nextSibling;i(t)}(e)}function htmlspecialchars(e){return"<pre>"+e.replace(/&(?![\w\#]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")+"</pre>"}console.log("\n\n WIDGZARD v.0.2\n\n");var __clearerClassName="clearer",__nodeIdentifier="wid",__autoclean=!0,__debug=!1,__promise=EW.Promise,__renders={};Wnode.prototype.climb=function(e){e=e||1;for(var t=this;e--;)t=t.parent;return t},Wnode.prototype.descendant=function(){var e=this,t=Array.prototype.slice.call(arguments,0),n=0,o=e,r=t.length;if(!r)return o;for(;n<r;)o=o.childrens[~~t[n++]];return o},Wnode.prototype.setAttrs=function(e,t){if(void 0!==t)for(var n in t)"class"!==n?"style"!==n?e.setAttribute(n,t[n]):this.setStyle(e,t.style):e.className=t[n];return this},Wnode.prototype.setStyle=function(e,t,n){if(void 0!==t)for(n in t)e.style[n.replace(/^float$/i,"cssFloat")]=t[n];return this},Wnode.prototype.setData=function(e,t){return e.data=t||{},this},Wnode.prototype.checkInit=function(e,t){return"init"in t&&"function"==typeof t.init&&!t.init.call(e)&&e.abort(),this},Wnode.prototype.checkEnd=function(e,t){return"end"in t&&"function"==typeof t.end&&this.root.endFunctions.push(function(){t.end.call(e)}),this},Wnode.prototype.render=function(){var conf=this.conf,node=this.node,tmp,i,j,k;return this.setAttrs(node,conf.attrs).setStyle(node,conf.style).setData(this,conf.data).checkInit(this,conf).checkEnd(this,conf),void 0!==conf.html&&(node.innerHTML=replaceDataInHTML(conf.html,conf.data)),tmp=node.getAttribute("wwdb"),tmp&&(node.removeAttribute("wwdb"),void 0!==(i=EW.checkNs(tmp,this))&&(j=("this."+tmp).split("."),k=j.pop(),i=eval(j.join(".")),k in i&&EW.events.ww.on(i,k,node))),void 0!==conf.text&&(tmp=document.createTextNode(""+conf.text),node.appendChild(tmp)),void 0!==conf[__nodeIdentifier]&&(this.map[conf[__nodeIdentifier]]=this),(conf.target||this.target.node).appendChild(node),"childrens"in(conf.target||this.target)||((conf.target||this.target).childrens=[]),(conf.target||this.target).childrens.push(this),this.WIDGZARD=!0,(!conf.content||0==conf.content.length)&&this.WIDGZARD_cb.call(this),this},EW.Widgzard={render:render,cleanup:cleanup,get:get,load:load,htmlspecialchars:htmlspecialchars,getElement:function(e){return e in __renders&&__renders[e]},getElements:function(){return __renders},Promise:__promise}}(this),function(){"use strict";function e(){return{}}function t(e,t){var n=e.states.length,o=e.states[n-1];e.listeners.forEach(function(e){e(o,t)}),e.states[n]=t}function n(t,n){this.reducer=t||e,this.state=n||t(),this.states=[this.state],this.listeners=[]}n.prototype.getState=function(){return this.states[this.states.length-1]},n.prototype.dispatch=function(e){if(!("type"in e))throw new Error("Actions needs a type");var n,o=e.type,r=this.states[this.states.length-1],i=this.reducer(r,o);for(n in e)"type"!==n&&(i[n]=e[n]);t(this,i)},n.prototype.subscribe=function(e){var t,n=this;return this.listeners.push(e),t=this.listeners.length-1,function(){n.listeners=n.listeners.slice(0,t).concat(n.listeners.slice(t+1))}},n.prototype.all=function(){return this.states.concat()},n.prototype.back=function(e){var t=this.states.length-1,n=t-e,o=n>-1?n:0,r=this.states[o];pushState(this,r)},EW.getStore=function(e,t){return new n(e,t)}}(),EW.makeNs("Engy",function(){function _configSet(e){var t;for(t in config)t in e&&(config[t]=e[t]);return this}function _overwrite(e,t,n){for(var o=t.split(/\.|\//),r=o.length,i=0;i<r-1;)e=e[o[i++]];e[o[r-1]]=n}function _mergeComponent(e,t,n){var o,r=EW.checkNs(t,e),i=n,c={},a=t.split(/\.|\//),o=0;a.length;for(o in i)c[o]=i[o];for(o in r)!o.match(/component|params/)&&(c[o]=r[o]);_overwrite(e,t,c)}function Processor(e){this.config=e,this.endPromise=EW.Promise.create()}function _process(e){return new Processor(e).run()}function _component(e,t){e in preloadedComponents||(preloadedComponents[Processor.prototype.getFileName(e)]=t)}function _components(e){for(var t in e)_component(t,e[t])}function _clone(e){if(null==e||"object"!=typeof e)return e;var t=e.constructor();for(var n in e)e.hasOwnProperty(n)&&(t[n]=_clone(e[n]));return t}console.log("\n\n ENGY v.0.3\n\n");var components={},preloadedComponents={},config={fileNameSeparator:"/",fileNamePrepend:"",ext:".js",componentsUrl:"/components/"},num=0;return Processor.prototype.getFileName=function(e){var t=e.split(/\/|\|/),n=e,o=t.length;return t[o-1]=config.fileNamePrepend+t[o-1],n=t.join(config.fileNameSeparator),config.componentsUrl+(config.componentsUrl.match(/\/$/)?"":"/")+n+config.ext},Processor.prototype.run=function(){var self=this,langFunc=EW.i18n.parse,elementsN=0,countPromise=EW.Promise.create(),solveTime=EW.Promise.create(),start=+new Date,end,xhrTot=0,cback;return function solve(){var component=EW.object.digForKey(self.config,"component",1),componentName,cached,preLoaded,innerPromise=EW.Promise.create(),xhrStart=0,xhrEnd=0;innerPromise.then(solve),component.length?(elementsN++,component=component[0],componentName=self.getFileName(component.value),cached=componentName in components,preLoaded=componentName in preloadedComponents,cback=function(cntORobj){xhrEnd=+new Date,xhrTot+=xhrEnd-xhrStart;var params=EW.checkNs(component.container+"/params",self.config),obj,usedParams,foundParam,foundParamValue,foundParamValueReplaced,i,l;if(preLoaded?obj=_clone(cntORobj):(cached||(components[componentName]=_clone(cntORobj)),cntORobj=cntORobj.replace(/^[^{]*/,"").replace(/;?$/,""),obj=eval("("+cntORobj+")")),params&&(usedParams=EW.object.digForValue(obj,/#PARAM{([^}|]*)?\|?([^}]*)}/),l=usedParams.length))for(i=0;i<l;i++)foundParam=EW.checkNs(usedParams[i].regexp[1],params),foundParamValue=void 0!==foundParam?foundParam:usedParams[i].regexp[2]||"",(typeof foundParamValue).match(/string/i)?(foundParamValueReplaced=EW.checkNs(usedParams[i].path,obj).replace(usedParams[i].regexp[0],foundParamValue),_overwrite(obj,usedParams[i].path,foundParamValueReplaced)):_overwrite(obj,usedParams[i].path,foundParamValue);component.container?_mergeComponent(self.config,component.container,obj):self.config=obj,innerPromise.done()},xhrStart=+new Date,preLoaded?cback(preloadedComponents[componentName]):cached?cback(components[componentName]):EW.io.get(componentName,cback,!0)):(end=+new Date,self.endPromise.done(self.config),countPromise.done(elementsN),solveTime.done(end-start))}(),langFunc&&langFunc(self.config),countPromise.then(function(e,t){console.log("Engy used "+t[0]+" component"+(1==t[0]?"":"s"))}),solveTime.then(function(e,t){console.log("Engy total time: "+t[0]+"ms"),console.log('      "       unfolding : '+(t[0]-xhrTot)+"ms"),console.log('      "       xhr : '+xhrTot+"ms")}),self.endPromise},{component:_component,components:_components,configSet:_configSet,define:_component,get:function(e,t,n){var o=EW.Promise.create();return _process(e).then(function(e,t){o.done(EW.Widgzard.get(t[0]))}),o},load:function(e){return EW.Widgzard.load(e)},getElement:function(e){return EW.Widgzard.getElement(e)},getElements:function(){return EW.Widgzard.getElements()},process:_process,render:function(e,t,n){var o=+new Date,r=EW.Promise.create();return _process(e).then(function(e,i){console.log("t: "+(+new Date-o)),r.done(EW.Widgzard.render(i[0],t,n))}),r}}},EW)}();