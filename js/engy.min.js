FG.makeNS("FG/engy"),FG.engy.config={componentsUrl:"/engy/components/",lazyLoading:!0},FG.engy.process=function(){function copyWithNoComponentNorParams(n){var o={};for(var e in n)e.match(/params|component/)||(o[e]=n[e]);return o}function build(n,o){var e,r,t,s,c,i,p,a=n.components,m=n.config,f=a.length;for(solve=function(n,o){var e,r,t,s,c,i=FG.object.digForValue(n,/#PARAM{([^}|]*)?\|?([^}]*)}/);for(e=0,r=i.length;r>e;e++)t=FG.checkNS(i[e].regexp[1],o),s=i[e].regexp[2],c=FG.checkNS(i[e].container,n),c[i[e].key]=void 0!==t?t:s||!1;return copyWithNoComponentNorParams(n)};f--;)if(a[f])for(e=0,r=a[f].length;r>e;e++)t=a[f][e],s=t.params,c=t.json,i=solve(c,s),p=FG.checkNS(t.component.parentContainer,m),void 0!=t.component.parentKey?p[t.component.parentKey]=i:n.config=i;o.done(n)}var args=[].slice.call(arguments,0),config=args[0],endPromise=Widgzard.Promise.create(),Processor,processorPROTO,getComponentsManager,outConfig={};return Processor=function(n){this.components=[],this.retFuncs=[],this.config=n},processorPROTO=Processor.prototype,processorPROTO.getComponents=function(){var n,o,e=this,r=FG.object.digForKey(e.config,"component");for(n=0,o=r.length;o>n;n++)e.components[r[n].level]||(e.components[r[n].level]=[]),e.components[r[n].level].push({component:r[n],params:FG.checkNS(r[n].container?r[n].container+".params":"params",e.config)})},processorPROTO.getComponentsPromise=function(){var self=this,p=Widgzard.Promise.create(),i1,i2,l1,l2;for(self.getComponents(),self.retFuncs=[],i1=0,l1=self.components.length;l1>i1;i1++)if(self.components[i1])for(i2=0,l2=self.components[i1].length;l2>i2;i2++)!function(j1,j2){self.retFuncs.push(function(){var pr=Widgzard.Promise.create(),file=FG.engy.config.componentsUrl+self.components[j1][j2].component.value+".js";return FG.io.get(file,function(r){self.components[j1][j2].json=eval("("+r.replace(/\/n|\/r/g,"")+")"),pr.done()}),pr})}(i1,i2);return p.done(),p},processorPROTO.run=function(){var n,o,e,r,t=this;if(FG.engy.config.lazyLoading)t.getComponentsPromise().then(function(){var n=t.retFuncs.length?Promise.join(t.retFuncs):Promise.create();n.then(function(n){build(t,n)}).then(function(n,o){endPromise.done(o[0].config)}).done()});else{for(t.getComponents(),n=0,e=t.components.length;e>n;n++)if(t.components[n])for(o=0,r=t.components[n].length;r>o;o++)t.components[n][o].json=FG.components[t.components[n][o].component.value];var s=Widgzard.Promise.create();s.then(function(n,o){endPromise.done(o[0].config)}),build(t,s)}},new Processor(config).run(),endPromise};