!function(t){"use strict";function e(t,n,r){var o,a=".",i=t.split(/\.|\//),c=i.length,s="undefined";return typeof r===s&&(r=window),typeof n===s&&(n={}),r[i[0]]||(r[i[0]]=1===c?n:{}),o=r[i[0]],c>1?e(i.slice(1).join(a),n,r[i[0]]):o}var n=!1;e(t,{makeNS:e,debug:function(t){n=!!t},dbg:function(t){if(!n)return void 0;try{console.log(t)}catch(e){try{opera.postError(t)}catch(r){alert(t)}}}}),e(t+".utils",{uniqueId:new function(){var e=0,n=this;this.prefix=t+"_",this.toString=function(){return n.prefix+ ++e}}})}("FG"),FG.makeNS("FG/io"),FG.io=function(){var W=window,_={getxhr:function(){var t,e=["Msxml2.XMLHTTP","Msxml3.XMLHTTP","Microsoft.XMLHTTP"],n=e.length,r=0;try{t=new W.XMLHttpRequest}catch(o){for(null;n>r;r+=1)try{t=new W.ActiveXObject(e[r])}catch(a){continue}!t&&alert("No way to initialize XHR")}return t},ajcall:function(t,e){var n=_.getxhr(),r=e&&e.method||"POST",o=e&&e.cback,a=e&&e.opened||function(){},i=e&&e.loading||function(){},c=e&&e.error||function(){},s=e&&e.abort||function(){},l=e&&e.sync,u=e&&e.data||!1,d=e&&e.type||"text/html",h=e&&void 0!==e.cache?e.cache:!0,f="xml"===d?"responseXML":"responseText",p=e&&e.timeout||3e3,y=!1,m=!1,g=!1,v=!1;h||(u.C=+new Date),u=H24.object.toQs(u).substr(1),n.onreadystatechange=function(){var t;if(v===n.readyState)return!1;if(v=n.readyState,"complete"===n.readyState||4===n.readyState&&200===n.status)return y=!0,o&&(m=n[f],function(){o(m)}(m)),g=n[f],W.setTimeout(function(){n=null},50),g;if(3===n.readyState)i(n);else if(2===n.readyState)a(n);else if(1===n.readyState)switch(r){case"POST":try{n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.send(u||!0)}catch(e){}break;case"GET":try{t={xml:"text/xml",html:"text/html",json:"application/json"}[d]||"text/html",n.setRequestHeader("Accept",t+"; charset=utf-8"),n.send(null)}catch(c){}break;default:alert(r),n.send(null)}return!0},n.onerror=function(){c&&c.apply(null,arguments)},n.onabort=function(){s&&s.apply(null,arguments)},n.open(r,"GET"===r?t+(u?"?"+u:""):t,l),W.setTimeout(function(){y||(y=!0,n.abort())},p);try{return"responseXML"===f?n[f].childNodes[0]:n[f]}catch(D){}return!0}};return{getxhr:_.getxhr,post:function(t,e,n,r,o,a){return _.ajcall(t,{cback:e,method:"POST",sync:n,data:r,cache:o,error:a})},get:function(t,e,n,r,o,a){return _.ajcall(t,{cback:e||function(){},method:"GET",sync:n,data:r,cache:o,error:a})},getJson:function(uri,cback,data){return _.ajcall(uri,{type:"json",method:"GET",sync:!1,cback:function(r){cback(W.JSON&&W.JSON.parse?JSON.parse(r):eval("("+r+")"))},data:data})},getXML:function(t,e){return _.ajcall(t,{method:"GET",sync:!1,type:"xml",cback:e||function(){}})}}}(),FG.makeNS("FG/events"),FG.events.bind=function(t){var e;return e="addEventListener"in t?function(t,e,n){t.addEventListener.apply(t,[e,n,!1])}:"attachEvent"in t?function(t,e,n){t.attachEvent.apply(t,["on"+e,n])}:function(){throw new Error("No straight way to bind an event")}}(this),function(t){"use strict";function e(t,e,n){var r=this,a=t.tag||"div";this.target=e,this.node=document.createElement(a),this.conf=t,this.node.WIDGZARD_cb=t.cb||function(){r.node.resolve()},this.node.WIDGZARD_promise=new o,this.node.WIDGZARD_promise.then(e.WIDGZARD_cb,e),this.map=n.map,this.node.getNode=n.getNode,this.node.WIDGZARD_len=t.content?t.content.length:0,this.node.done=this.node.resolve=function(){!--r.target.WIDGZARD_len&&r.node.WIDGZARD_promise.done()}}function n(t){var e=["WIDGZARD","WIDGZARD_cb","WIDGZARD_promise","WIDGZARD_length","getNode","done","resolve","data"],n=[],r=0,o=e.length,a=function(t){var e=t.parentNode;return e.removeChild(t),!0};i(t,function(e){e!==t&&3!=e.nodeType&&n.push(e)},"post");for(var c=0,s=n.length;s>c;c++){var l=n[c];for(null;o>r;r++)l[e[r]]=null;a(l)}console.log("autoclean")}function r(t,r){var o=t.target||document.body;if(u&&o.WIDGZARD&&n(o),!t)throw new Exception("ERROR : Check parameters for render function");var a={map:{},getNode:function(t){return a.map[t]||!1}};e.prototype.setAttrs(o,t.attrs).setStyle(o,t.style).setData(o,t.data),r&&(o.innerHTML=""),"undefined"!=typeof t.html&&(o.innerHTML=t.html),o.WIDGZARD_len=t.content.length,o.WIDGZARD_cb=t.cb||function(){},o.WIDGZARD=!0,o.getNode=a.getNode,function i(t,n){if(t.content)for(var r=0,o=t.content.length;o>r;r++)t.content[r]===l&&(t.content[r]={tag:"br",attrs:{"class":l}}),i(t.content[r],new e(t.content[r],n,a).add())}(t,o)}function o(){this.cbacks=[],this.len=0,this.completed=!1,this.res=!1,this.err=!1,this.reset=function(){this.len=0,this.cbacks=[]}}var a,i,c,s,l="clearer",u=!0;e.prototype.setAttrs=function(t,e){if("undefined"!=typeof e)for(var n in e)"class"!==n?"style"!==n?t.setAttribute(n,e[n]):this.setStyle(t,e.style):t.className=e[n];return this},e.prototype.setStyle=function(t,e){if("undefined"!=typeof e)for(var n in e)t.style[n.replace(/^float$/i,"cssFloat")]=e[n];return this},e.prototype.setData=function(t,e){return t.data=e||{},this},e.prototype.add=function(){var t=this.conf,e=this.node;return this.setAttrs(e,t.attrs).setStyle(e,t.style).setData(e,t.data),"undefined"!=typeof t.html&&(e.innerHTML=t.html),"undefined"!=typeof t.wid&&(this.map[t.wid]=e),(t.target||this.target).appendChild(e),e.WIDGZARD=!0,!t.content&&e.WIDGZARD_cb.call(e),e},o.prototype.done=function(t,e){var n=0;for(this.completed=!0,this.res=t,this.err=e,null;n<this.len;n+=1)this.cbacks[n](t,e);this.reset()},o.prototype.then=function(t,e){var n=a(t,e);return this.completed?n(this.res,this.err):(this.cbacks[this.len]=n,this.len+=1),this},i=function(t,e,n){n={pre:"pre",post:"post"}[n]||"post";var r=function(){},o="pre"===n?e:r,a="post"===n?e:r,i=function(){return function(t,e){for(o(t),e=t.firstChild;e;)i(e),e=e.nextSibling;a(t)}}(n);i(t)},a=function(t,e){var n=Array.prototype.slice.call(arguments,2);return function(){return t.apply(e||window,[].concat(n,Array.prototype.slice.call(arguments)))}},s=function(t){var e=document.createElement("script");document.getElementsByTagName("head")[0].appendChild(e),e.src=t,e.onload=function(){e.parentNode.removeChild(e)}},c=function(t){return"<pre>"+t.replace(/&(?![\w\#]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},t.Widgzard={render:r,load:s,htmlspecialchars:c}}(this);