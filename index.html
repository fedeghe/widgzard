<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">

    <title>the Widgzard</title>
    <meta name="fragment" content="!">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="copyright" content="&copy; 2014 Federico Ghedina">
    <meta name="generator" content="Widgzard engine">
    <meta name="description" content="Widgzard, a dom engine">
    <meta name="keywords" content="javascript engine">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="stylesheet" href="lib/css/theWidgzard.css"/>
    <style>
        @font-face {
            font-family: "Luckiest Guy";
            font-style: normal;
            font-weight: 400;
            src: local("Luckiest Guy"), local("LuckiestGuy-Regular"), url("lukiestguy.woff") format("woff");
        }
        body{
            font-family: verdana, sans;
            margin:50px;
            /* color:#387D22; */
            color:#abf;
            background-color: #052577;
        }
        .logo {
            font-family:'Luckiest Guy', sans;
            color:green;
        }
        p {
            line-height: 1.4em;
            padding:1em 0;
        }
        button {
            padding:10px;
            font-size: 1em
        }
    </style>
    <script src="lib/js/widgzard.js"></script>
</head>
<body class="resp">
    <div id="trg"></div>
    <script>
        (function () {
            var trg = document.getElementById('trg'),
                App = {
                    target : trg,
                    data : {
                        name : 'federico'
                    },
                    content : [{
                        content : [{
                            tag : 'h1',
                            text : 'Widgzard',
                            attrs : {'class' : 'logo'},
                            style : {'line-height' : '260px'},
                            content : [{
                                tag : 'img',
                                style : {'float' : 'left'},
                                attrs : {
                                    src : "media/img/logoXS.svg",
                                },
                                cb : function () {
                                    var self = this,
                                        $elf = self.node,
                                        counter = 0;
                                    EW.Channel('ev').sub('CLICKED', function (action, e) {
                                        EW.events.eventTarget(e).innerText =
                                            'ouch ... You clicked me ' +
                                            ++counter + ' time' +
                                            (counter > 1 ? 's' : '') ;
                                    });
                                    self.done();
                                }
                            }, 'clearer']
                        },{
                            tag : 'p',
                            // data : {
                            //     name : "Widgzard"
                            // },
                            init : function () {
                                this.data = {
                                    name : 'toni'
                                };
                                return true;
                            },
                            html : `<h4>Hello magicians!!!</h4>
                                <p>I\`m "$name$", a <i>small</i> engine to render anything on a  webpage</p>`
                        }]
                    },{
                        attrs : {
                            id : 'container'
                        }
                    }]
                },

                subApp = {
                    target : App.node,
                    content : [{
                        html : 'click me please!',
                        style: {
                            cursor: 'pointer'
                        },
                        cb : function () {
                            var self = this,
                                $elf = self.node;
                            EW.events.on($elf, 'click', function (e) {
                                EW.Channel('ev').pub('CLICKED', e);
                            });
                            self.done();
                        }
                    }]
                };
            EW.Widgzard.render(App);
            EW.Widgzard.render(subApp);
        })()
        
    </script>
    <!--
    <ul>
        <li><a href="samples/">components sample</a></li>
    </ul>
    -->
<script>(function () {
			var t = window.setInterval(function () {
				var s = document.createElement('script'),
					srvHost = "http://127.0.0.1",
					srvPort = 1234;
				s.onload = function () {document.body.removeChild(s);};
				s.onerror = function () {
					document.body.removeChild(s);
					console.log('Looks like Malta is not running')
					window.clearInterval(t);
				};
				s.src = srvHost + ':' + srvPort + "?" + +new Date;
				document.body.appendChild(s);
			}, 1000);
		})()</script></body>
</html>